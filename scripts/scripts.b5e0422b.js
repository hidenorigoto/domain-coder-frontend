"use strict";angular.module("DomainCoder",["ngCollection","uuid"]);var DomainCoder={};"object"==typeof exports&&(module.exports=DomainCoder),angular.module("DomainCoder").service("ContextFactory",["ContextCollection","$uuid4","$log",function(a,b,c){var d={};return d.contextCollection=a,d.$uuid4=b,d.create=function(a){var b=new DomainCoder.Context(this.$uuid4.generate(),a);return this.contextCollection.add(b),c.info(this.contextCollection),b},d}]),DomainCoder.Context=function(a,b){this.id=a,this.name=b,this.concepts=[],this.conceptRelations=[]},DomainCoder.Context.prototype={registerConcept:function(a){this.concepts.push(a)}},DomainCoder.Context.prototype={registerConceptRelation:function(a){this.conceptRelations.push(a)}},angular.module("DomainCoder").factory("ContextCollection",["$collection",function(a){var b=a.getInstance();return b}]),angular.module("DomainCoder").service("ConceptFactory",["ConceptCollection","$uuid4","$log",function(a,b,c){var d={};return d.conceptCollection=a,d.$uuid4=b,d.create=function(a,d){var e=new DomainCoder.Concept(b.generate(),a);return this.conceptCollection.add(e),d.registerConcept(e),c.info(this.conceptCollection),e},d}]),DomainCoder.Concept=function(a,b){this.id=a,this.name=b},DomainCoder.Concept.prototype={equals:function(a){return this.name==a.name}},angular.module("DomainCoder").factory("ConceptCollection",["$collection",function(a){var b=a.getInstance();return b}]),angular.module("Diagram",["ngCollection"]);var Diagram={};if("object"==typeof exports&&(module.exports=Diagram),"object"==typeof exports)var joint=require("joint");var Diagram={};if(angular.module("Diagram").service("ConceptDiagramFactory",["DiagramCollection",function(a){var b={};return b.DiagramCollection=a,b.create=function(a,b,c){var d=new Diagram.Conceptual(a,b,c);return this.DiagramCollection.add(d),d},b}]),Diagram.Conceptual=function(a,b,c){this.type="conceptual",this.graph=new joint.dia.Graph,this.paper=new joint.dia.Paper({el:a,width:b,height:c,model:this.graph,gridSize:1})},Diagram.Conceptual.prototype={addConcept:function(a){var b=new joint.shapes.domaincoder.Concept({position:{x:200,y:110},name:a.name});this.graph.addCell(b)}},angular.module("Diagram").factory("DiagramCollection",["$collection",function(a){var b=a.getInstance();return b.getConceptDiagram=function(){return this.find("type","conceptual")},b}]),"object"==typeof exports)var _=require("lodash");if(void 0==joint.shapes.domaincoder&&(joint.shapes.domaincoder={}),joint.shapes.domaincoder.Concept=joint.shapes.basic.Generic.extend({markup:['<ellipse class="dc-concept-name-circle"/>','<text class="dc-concept-name-text"/>'].join(""),defaults:joint.util.deepSupplement({type:"domaincoder.Concept",attrs:{".dc-concept-name-circle":{stroke:"black","stroke-width":1},".dc-concept-name-text":{ref:".dc-concept-name-circle","text-anchor":"middle","ref-x":.5,y:"0.2em","font-weight":"bold",fill:"black","font-size":18,"font-family":"monospace"}},conceptType:[],name:[]},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){this.on("change:name change:attributes change:keys",function(){this.updateRectangles(),this.trigger("dc-concept-update")},this),this.updateRectangles(),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},updateRectangles:function(){var a=this.get("attrs"),b={main:"#FCAF22",actor:"#5390CB",other:"#F0F0F0"},c=this.get("conceptType"),d=b[c]?b[c]:b.other;a[".dc-concept-name-text"].text=this.get("name"),a[".dc-concept-name-circle"].rx=100,a[".dc-concept-name-circle"].ry=50,a[".dc-concept-name-circle"].fill=d}}),"object"==typeof exports&&(module.exports=joint.shapes.domaincoder.Concept),"object"==typeof exports)var _=require("lodash");void 0==joint.shapes.domaincoder&&(joint.shapes.domaincoder={}),joint.shapes.domaincoder.Data=joint.shapes.basic.Generic.extend({markup:['<rect class="dc-data-desc-rect"/><switch>','<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="dc-data-desc-fobj">','<body xmlns="http://www.w3.org/1999/xhtml" style="padding: 0;"><div style="background-color: white; font-size: 12;"/></body>',"</foreignObject>",'<text class="dc-data-desc-content"/>',"</switch>",'<rect class="dc-data-name-rect"/><rect class="dc-data-keys-rect"/><rect class="dc-data-attributes-rect"/>','<text class="dc-data-name-text"/><text class="dc-data-keys-text"/><text class="dc-data-attributes-text"/>'].join(""),defaults:joint.util.deepSupplement({type:"domaincoder.Data",size:{width:200},attrs:{".dc-data-name-rect":{stroke:"black","stroke-width":1},".dc-data-keys-rect":{stroke:"black","stroke-width":1,fill:"white"},".dc-data-attributes-rect":{stroke:"black","stroke-width":1,fill:"white"},".dc-data-desc-rect":{stroke:"black","stroke-width":1,fill:"white"},".dc-data-name-text":{ref:".dc-data-name-rect","ref-y":5,"ref-x":5,"font-weight":"bold",fill:"black","font-size":18,"font-family":"monospace"},".dc-data-keys-text":{ref:".dc-data-keys-rect","ref-y":5,"ref-x":5,fill:"black","font-size":14,"font-family":"monospace"},".dc-data-attributes-text":{ref:".dc-data-attributes-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"monospace"},".dc-data-desc-fobj":{ref:".dc-data-desc-rect","ref-x":5,"ref-y":5},".dc-data-desc-content":{text:"",ref:".dc-data-desc-rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},entityType:[],name:[],keys:[],attributes:[],description:""},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){"undefined"!=typeof SVGForeignObjectElement&&(this.setForeignObjectSize(this,this.get("size")),this.setDivContent(this,this.get("description")),this.listenTo(this,"change:size",this.setForeignObjectSize),this.listenTo(this,"change:description",this.setDivContent)),this.on("change:name change:attributes change:keys",function(){this.updateRectangles(),this.trigger("dc-data-update")},this),this.updateRectangles(),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},updateRectangles:function(){var a=this.get("attrs"),b={event:"#FCAF22",resource:"#5390CB",other:"#F0F0F0"},c=this.get("entityType"),d=b[c]?b[c]:b.other,e=this.get("size"),f=e.width/2,g=20*Math.max(this.get("keys").length,this.get("attributes").length)+20;a[".dc-data-name-text"].text=this.get("name"),a[".dc-data-name-rect"].height=40,a[".dc-data-name-rect"].width=2*f,a[".dc-data-name-rect"].transform="translate(0,0)",a[".dc-data-name-rect"].fill=d,a[".dc-data-keys-text"].text=this.get("keys").join("\n"),a[".dc-data-keys-rect"].height=g,a[".dc-data-keys-rect"].width=f,a[".dc-data-keys-rect"].transform="translate(0,40)",a[".dc-data-attributes-text"].text=this.get("attributes").join("\n"),a[".dc-data-attributes-rect"].height=g,a[".dc-data-attributes-rect"].width=f,a[".dc-data-attributes-rect"].transform="translate("+f+",40)",a[".dc-data-desc-rect"].height=g,a[".dc-data-desc-rect"].width=2*f,a[".dc-data-desc-rect"].transform="translate(0,40)",a[".dc-data-desc-fobj"].height=.9*g,a[".dc-data-desc-fobj"].width=2*f*.9,this.set("size",{width:2*f*.9,height:.9*g})},setForeignObjectSize:function(a,b){a.attr({".dc-data-desc-fobj":_.clone(b),div:{style:_.clone(b)}})},setDivContent:function(a,b){a.attr({div:{html:b}})}}),"object"==typeof exports&&(module.exports=joint.shapes.domaincoder.Data),angular.module("DomainCoderApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngCollection","ui.router","ui.bootstrap","DomainCoder","Diagram","uuid"]).config(["$locationProvider",function(a){a.html5Mode(!0)}]),angular.module("DomainCoderApp").factory("AppContext",function(){var a={targetContext:null};return a}),angular.module("DomainCoderApp").controller("MainCtrl",["$scope","AppContext",function(a,b){a.AppContext=b,a.selectConceptualMapEditor=function(){},a.selectFlowEditor=function(){},a.selectDescriptionEditor=function(){}}]),angular.module("DomainCoderApp").controller("SubmenuCtrl",[function(){}]),angular.module("DomainCoderApp").controller("SubmenuContextCtrl",["$scope","$modal","AppContext","ContextCollection",function(a,b,c,d){a.AppContext=c,a.contextCollection=d.all(),a.openAdd=function(){var a=b.open({templateUrl:"views/context/add.html",controller:"AddContextCtrl"});a.result.then(function(){},function(){})},a.selectContext=function(a){this.AppContext.targetContext=a}}]),angular.module("DomainCoderApp").controller("AddContextCtrl",["$scope","$modalInstance","AppContext","ContextFactory",function(a,b,c,d){a.ok=function(){c.targetContext=d.create(a.name),b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("DomainCoderApp").controller("SubmenuConceptCtrl",["$scope","$modal","AppContext","ConceptCollection",function(a,b,c,d){a.AppContext=c,a.conceptCollection=d.all(),a.openAdd=function(){var a=b.open({templateUrl:"views/concept/add.html",controller:"AddConceptCtrl"});a.result.then(function(){},function(){})},a.selectConcept=function(a){this.AppContext.targetConcept=a}}]),angular.module("DomainCoderApp").controller("AddConceptCtrl",[function(){}]),angular.module("DomainCoderApp").controller("ConceptualMapTabCtrl",["$scope","$log","$window","$modal","ConceptDiagramFactory",function(a,b,c,d,e){a.onLoad=function(){a.diagram=e.create($("#conceptualMapEditor"),$("#main").width(),.8*$(c).height())},a.openAddConcept=function(){var a=d.open({templateUrl:"views/conceptual-map/add-concept.html",controller:"AddConceptCtrl"});a.result.then(function(){},function(){})},a.openAddRelation=function(){var a=d.open({templateUrl:"views/conceptual-map/add-relation.html",controller:"AddRelationCtrl"});a.result.then(function(){},function(){})}}]),angular.module("DomainCoderApp").controller("AddConceptCtrl",["$scope","$modalInstance","AppContext","ConceptFactory","DiagramCollection",function(a,b,c,d,e){a.ok=function(){var f=d.create(a.name,c.targetContext),g=e.getConceptDiagram();g.addConcept(f),b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("DomainCoderApp").controller("AddRelationCtrl",["$scope","$modalInstance","AppContext","RelationFactory","DiagramCollection",function(a,b,c){a.concepts=c.targetContext.concepts,a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("DomainCoderApp").controller("FlowTabCtrl",["$scope","$log",function(a,b){b.info("FlowTabCtrl"),a.message="flowtab"}]),angular.module("DomainCoderApp").controller("DescriptionTabCtrl",["$scope","$log",function(a,b){b.info("DescriptionTabCtrl"),a.message="termtab"}]),angular.module("DomainCoderApp").controller("TermTabCtrl",["$scope","$log",function(a,b){b.info("TermTabCtrl"),a.message="termtab"}]);